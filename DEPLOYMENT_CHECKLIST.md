# SAFMC FMP Tracker - Deployment Checklist

## ‚úÖ Pre-Deployment Verification

### Environment Configuration
- [x] `.env` file created with Claude API key
- [x] `CLAUDE_API_KEY` configured: `your-claude-api-key-here`
- [x] `CLAUDE_MODEL` configured: `claude-sonnet-4.5-20250929`
- [x] Database URL configured (will be updated for production)
- [x] Secret key set (will be regenerated for production)

### Core Files
- [x] `app.py` - Main Flask application
- [x] `requirements.txt` - Python dependencies
- [x] `render.yaml` - Render deployment configuration
- [x] `.env.example` - Environment template
- [x] `Procfile` - Not needed (using render.yaml)

### Database Models
- [x] `src/models/action.py` - FMP actions/amendments
- [x] `src/models/meeting.py` - Meeting tracking
- [x] `src/models/comment.py` - Public comments
- [x] `src/models/milestone.py` - Action milestones
- [x] `src/models/scrape_log.py` - Scraping logs
- [x] `src/config/extensions.py` - DB extensions

### API Routes
- [x] `src/routes/api_routes.py` - REST API endpoints
- [x] `src/routes/web_routes.py` - Web page routes

### Services
- [x] `src/services/ai_service.py` - Claude AI integration
- [x] `src/services/scheduler.py` - Background job scheduler

### Scrapers
- [x] `src/scrapers/amendments_scraper.py` - SAFMC amendments scraper
- [x] `src/scrapers/meetings_scraper.py` - SAFMC meetings scraper
- [x] `src/scrapers/comments_scraper.py` - Public comments scraper

### Frontend
- [x] `public/index.html` - Main dashboard with AI panel
- [x] `public/js/app.js` - Frontend JavaScript
- [x] `public/css/styles.css` - Styling

### Documentation
- [x] `README.md` - Main documentation
- [x] `QUICKSTART.md` - Quick start guide
- [x] `DEPLOYMENT.md` - Deployment instructions
- [x] `ADVANCED_FEATURES.md` - AI and analytics features
- [x] `SETUP_COMPLETE.md` - Setup summary

## üöÄ Deployment Steps

### 1. Local Testing (Optional but Recommended)

```bash
# Set up virtual environment
python -m venv venv
source venv/bin/activate  # On Windows: venv\Scripts\activate

# Install dependencies
pip install -r requirements.txt

# Set up local PostgreSQL database
createdb safmc_fmp_tracker

# Initialize database
python init_db.py

# Run application
python app.py
```

Visit `http://localhost:5000` to test the application.

### 2. Initialize Git Repository

```bash
# Initialize git (if not already done)
git init

# Add all files
git add .

# Create .gitignore if needed
echo ".env
venv/
__pycache__/
*.pyc
*.pyo
.DS_Store
migrations/versions/*.pyc" > .gitignore

# Commit
git commit -m "Initial commit - SAFMC FMP Tracker ready for deployment"
```

### 3. Create GitHub Repository

```bash
# Create GitHub repo (using gh CLI)
gh auth login
gh repo create safmc-fmp-tracker --public --source=. --remote=origin

# Or manually:
# 1. Go to https://github.com/new
# 2. Create repository named "safmc-fmp-tracker"
# 3. Follow instructions to push existing repository

# Push to GitHub
git branch -M main
git push -u origin main
```

### 4. Deploy to Render

#### Option A: Using Render Dashboard (Recommended)

1. Go to [Render Dashboard](https://dashboard.render.com/)
2. Click "New +" ‚Üí "Blueprint"
3. Connect your GitHub repository
4. Select `safmc-fmp-tracker` repository
5. Render will automatically detect `render.yaml`
6. Review the services that will be created:
   - **Web Service**: safmc-fmp-tracker
   - **PostgreSQL Database**: safmc-fmp-tracker-db
7. Click "Apply" to start deployment

#### Option B: Using Render CLI

```bash
# Install Render CLI
npm install -g render-cli

# Login to Render
render login

# Deploy using blueprint
render blueprint launch
```

### 5. Configure Environment Variables on Render

After deployment starts, add these environment variables in Render dashboard:

**Required:**
- `CLAUDE_API_KEY`: `your-claude-api-key-here`
- `CLAUDE_MODEL`: `claude-sonnet-4.5-20250929`
- `SECRET_KEY`: (will be auto-generated by Render)
- `FLASK_ENV`: `production`
- `ENABLE_SCHEDULER`: `true`

**Automatic (provided by Render):**
- `DATABASE_URL`: Auto-configured PostgreSQL connection string

### 6. Monitor Deployment

1. Watch the build logs in Render dashboard
2. Wait for "Your service is live" message (typically 5-10 minutes)
3. Click on the service URL to open your application

### 7. Initialize Data

Once deployed, trigger the initial data scrape:

```bash
# Get your Render service URL (e.g., https://safmc-fmp-tracker.onrender.com)
SERVICE_URL="https://safmc-fmp-tracker.onrender.com"

# Trigger scraping
curl -X POST "$SERVICE_URL/api/scrape/all"
```

Or use the "Update Data" button in the web interface.

### 8. Verify Deployment

Check these endpoints:

```bash
# Health check
curl $SERVICE_URL/health

# Dashboard stats
curl $SERVICE_URL/api/dashboard/stats

# AI query test
curl -X POST $SERVICE_URL/api/ai/query \
  -H "Content-Type: application/json" \
  -d '{"question": "What FMP actions are in progress?"}'
```

## üîß Post-Deployment Configuration

### Set Up Automatic Scraping

The scheduler is configured to run automatically, but verify:

1. Check logs in Render dashboard
2. Confirm daily scraping is running at 2 AM UTC
3. Adjust schedule in `src/services/scheduler.py` if needed

### Monitor Application

1. **Render Dashboard**: Monitor service health, logs, and metrics
2. **Health Endpoint**: `$SERVICE_URL/health`
3. **Scrape Logs**: `$SERVICE_URL/api/logs/scrape`

### Custom Domain (Optional)

1. Go to Render service settings
2. Add custom domain
3. Update DNS records as instructed by Render

## üìä Testing the AI Features

### Test AI Query

```bash
curl -X POST $SERVICE_URL/api/ai/query \
  -H "Content-Type: application/json" \
  -d '{
    "question": "What is the current status of Snapper Grouper amendments?"
  }'
```

### Test Pattern Analysis

```bash
curl -X POST $SERVICE_URL/api/ai/analyze
```

### Test Status Report

```bash
curl -X POST $SERVICE_URL/api/ai/report
```

### Test Content Search

```bash
curl -X POST $SERVICE_URL/api/ai/search \
  -H "Content-Type: application/json" \
  -d '{
    "search_terms": "bag limits dolphin"
  }'
```

## üêõ Troubleshooting

### Database Connection Issues

```bash
# Check database is provisioned
# In Render dashboard, verify PostgreSQL database is running

# Check DATABASE_URL is set
# In Render service environment variables
```

### AI Queries Not Working

```bash
# Verify API key is set correctly
# Check Render service logs for API errors

# Test API key directly
curl https://api.anthropic.com/v1/messages \
  -H "x-api-key: YOUR_API_KEY" \
  -H "anthropic-version: 2023-06-01" \
  -H "content-type: application/json" \
  -d '{
    "model": "claude-sonnet-4.5-20250929",
    "max_tokens": 10,
    "messages": [{"role": "user", "content": "test"}]
  }'
```

### Scraping Failures

```bash
# Check scrape logs
curl $SERVICE_URL/api/logs/scrape

# Manually trigger scraping
curl -X POST $SERVICE_URL/api/scrape/all
```

### Service Won't Start

1. Check Render build logs for errors
2. Verify all dependencies in `requirements.txt`
3. Check for syntax errors in Python files
4. Ensure database migrations ran successfully

## üìà Next Steps After Deployment

1. **Monitor Performance**: Watch Render metrics for response times
2. **Set Up Alerts**: Configure Render alerts for downtime
3. **Regular Updates**: Keep dependencies updated
4. **Backup Strategy**: Consider database backup schedule
5. **User Testing**: Get feedback from SAFMC stakeholders
6. **Feature Enhancements**: See roadmap in README.md

## üîê Security Considerations

- [x] `.env` file in `.gitignore` (secrets not in git)
- [x] API keys stored in environment variables only
- [x] SECRET_KEY is unique for production
- [x] Database credentials managed by Render
- [x] CORS configured appropriately
- [x] Input validation in API endpoints
- [x] SQL injection protection via SQLAlchemy ORM

## üìù Important URLs

**Production:**
- Service URL: `https://safmc-fmp-tracker.onrender.com` (will be assigned by Render)
- Dashboard: `https://dashboard.render.com`
- GitHub Repo: `https://github.com/yourusername/safmc-fmp-tracker`

**Documentation:**
- README: [README.md](README.md)
- Quick Start: [QUICKSTART.md](QUICKSTART.md)
- Deployment Guide: [DEPLOYMENT.md](DEPLOYMENT.md)
- Advanced Features: [ADVANCED_FEATURES.md](ADVANCED_FEATURES.md)

## ‚úÖ Final Checklist

Before marking deployment as complete:

- [ ] Application accessible at Render URL
- [ ] Health check returns "healthy" status
- [ ] Dashboard loads and displays correctly
- [ ] AI panel responds to queries
- [ ] Data scraping works (run manually first time)
- [ ] All API endpoints respond correctly
- [ ] Database migrations applied successfully
- [ ] Environment variables configured
- [ ] Automatic scheduler is running
- [ ] GitHub repository is up to date
- [ ] Documentation reviewed and accurate

## üéâ You're Live!

Your SAFMC FMP Tracker is now deployed and ready to use. Share the URL with stakeholders and start tracking fishery management plans!

For support or questions, see the documentation or open an issue on GitHub.
